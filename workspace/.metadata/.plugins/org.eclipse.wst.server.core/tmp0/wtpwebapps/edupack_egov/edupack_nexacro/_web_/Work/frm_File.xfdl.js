(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("frm_File");this.set_titletext("New Form");if(Form==this.constructor){this._setFormPosition(800,600);}_a=new Dataset("dsFile",this);_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"chkYN\" type=\"STRING\" size=\"256\"/><Column id=\"file_id\" type=\"STRING\" size=\"256\"/><Column id=\"file_name\" type=\"STRING\" size=\"256\"/><Column id=\"file_size\" type=\"STRING\" size=\"256\"/><Column id=\"file_type\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsDown",this);_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"chkYN\" type=\"STRING\" size=\"256\"/><Column id=\"file_id\" type=\"STRING\" size=\"256\"/><Column id=\"file_name\" type=\"STRING\" size=\"256\"/><Column id=\"file_size\" type=\"STRING\" size=\"256\"/><Column id=\"file_type\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new FileUpTransfer("FileUpTransfer00",this);this.addChild(_a.name,_a);_a=new FileDownTransfer("FileDownTransfer00",this);this.addChild(_a.name,_a);_a=new FileDialog("FileDialog00",this);this.addChild(_a.name,_a);_a=new Grid("grd00","40","42","720","118",null,null,null,null,null,null,this);_a.set_taborder("0");_a.set_binddataset("dsFile");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"60\"/><Column size=\"123\"/><Column size=\"123\"/><Column size=\"123\"/><Column size=\"123\"/><Column size=\"71\"/><Column size=\"71\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\"/><Cell col=\"1\" text=\"file_id\"/><Cell col=\"2\" text=\"file_name\"/><Cell col=\"3\" text=\"file_size\"/><Cell col=\"4\" text=\"file_type\"/><Cell col=\"5\"/><Cell col=\"6\"/></Band><Band id=\"body\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" text=\"bind:chkYN\"/><Cell col=\"1\" text=\"bind:file_id\"/><Cell col=\"2\" text=\"bind:file_name\"/><Cell col=\"3\" text=\"bind:file_size\"/><Cell col=\"4\" text=\"bind:file_type\"/><Cell col=\"5\" displaytype=\"buttoncontrol\" edittype=\"button\" text=\"다운로드\"/><Cell col=\"6\" displaytype=\"buttoncontrol\" edittype=\"button\" text=\"삭제\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btn00","40","184","120","26",null,null,null,null,null,null,this);_a.set_taborder("1");_a.set_text("파일 선택");this.addChild(_a.name,_a);_a=new Button("btn01","170","184","120","26",null,null,null,null,null,null,this);_a.set_taborder("2");_a.set_text("파일 업로드");this.addChild(_a.name,_a);_a=new Button("btn02","300","184","163","26",null,null,null,null,null,null,this);_a.set_taborder("3");_a.set_text("파일 목록 가져오기");this.addChild(_a.name,_a);_a=new Button("btn03","473","184","120","26",null,null,null,null,null,null,this);_a.set_taborder("4");_a.set_text("전체 다운로드");this.addChild(_a.name,_a);_a=new Button("btn04","610","184","120","26",null,null,null,null,null,null,this);_a.set_taborder("5");_a.set_text("선택다운로드");this.addChild(_a.name,_a);_a=new Button("btn05","610","224","120","26",null,null,null,null,null,null,this);_a.set_taborder("6");_a.set_text("다운2");this.addChild(_a.name,_a);_a=new Grid("grd01","50","250","440","122",null,null,null,null,null,null,this);_a.set_taborder("7");_a.set_binddataset("dsDown");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row band=\"head\" size=\"24\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"chkYN\"/><Cell col=\"1\" text=\"file_id\"/><Cell col=\"2\" text=\"file_name\"/><Cell col=\"3\" text=\"file_size\"/><Cell col=\"4\" text=\"file_type\"/></Band><Band id=\"body\"><Cell text=\"bind:chkYN\"/><Cell col=\"1\" text=\"bind:file_id\"/><Cell col=\"2\" text=\"bind:file_name\"/><Cell col=\"3\" text=\"bind:file_size\"/><Cell col=\"4\" text=\"bind:file_type\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Layout("default","",800,600,this,function(_b){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.registerScript("frm_File.xfdl",function(){this.btn00_onclick=function(_a,_b){this.FileDialog00.open("파일 선택",3,"%MYDOCUMENT%");};this.FileDialog00_onclose=function(_a,_b){var _c=_b.virtualfiles;for(var _h=0;_h<_c.length;_h++ ){var _d=this.FileUpTransfer00.existFile(_c[_h]);if(!_d){var _e=_c[_h].filename;this.FileUpTransfer00.addFile(_e,_c[_h]);var _f=this.dsFile.addRow();var _g=_e.substr(_e.lastIndexOf(".")+1);this.dsFile.setColumn(_f,"file_id",_e);this.dsFile.setColumn(_f,"file_name",_e);this.dsFile.setColumn(_f,"file_size",_e.length);this.dsFile.setColumn(_f,"file_type",_g);}}};this.btn01_onclick=function(_a,_b){var _c="SvcUrl::edu/uploadFile.do";this.FileUpTransfer00.setPostData("userPath","nexa_edu");this.FileUpTransfer00.upload(_c);};this.FileUpTransfer00_onsuccess=function(_a,_b){var _c=_b.datasets[0];for(var _e=0;_e<_c.rowcount;_e++ ){var _d=this.dsFile.findRow("file_id",_c.getColumn(_e,"file_id"));this.dsFile.findRow("file_id",_c.getColumn(_e,"file_id"));this.dsFile.findRow("file_id",_c.getColumn(_e,"file_name"));this.dsFile.findRow("file_id",_c.getColumn(_e,"file_size"));}trace(_c.saveXML());};this.btn02_onclick=function(_a,_b){this.transaction("getFileList","SvcUrl::edu/getFileList.do","","dsFile = ds_file","userPath='nexa_edu'","fn_callback");};this.grd00_oncellclick=function(_a,_b){if(_b.cell==4){var _c="SvcUrl::edu/downloadFile.do";var _d=this.dsFile.getColumn(_b.row,"file_id");this.FileDownTransfer00.setPostData("downFileId",_d);this.FileDownTransfer00.set_downloadfilename(_d);this.FileDownTransfer00.download(_c);}else if(_b.cell==5){var _d=this.dsFile.getColumn(_b.row,"file_id");this.transaction("deleteFile","SvcUrl::edu/deleteFile.do","","","userPath='nexa_edu' file_id="+nexacro.wrapQuote(_d),"fn_callback");}};this.fn_callback=function(_b,_c,_d){if(_b=="deleteFile"){this.dsFile.deleteRow(this.dsFile.rowposition);}};this.btn03_onclick=function(_a,_b){var _c="SvcUrl::edu/downloadFile.do";this.FileDownTransfer00.setPostData("downFileId","");var _d=this.dsFile.saveXML();this.FileDownTransfer00.setPostData("downloadDs",encodeURIComponent(encodeURIComponent(_d)));this.FileDownTransfer00.set_downloadfilename("첨부파일.zip");this.FileDownTransfer00.download(_c);};this.btn04_onclick=function(_a,_b){var _c=this.dsFile.findRow("chkYN",1);var _d=this.dsFile.getCaseCount("chkYN == '1'");if(_d==0){}else if(_d==1){var _e="SvcUrl::edu/downloadFile.do";var _f=this.dsFile.getColumn(_c,"file_id");this.FileDownTransfer00.setPostData("downFileId",_f);this.FileDownTransfer00.set_downloadfilename(_f);this.FileDownTransfer00.download(_e);}else{for(var _i=0;_i<this.dsFile.rowcount;_i++ ){if(this.dsFile.getColumn(_i,"chkYN")=="1"){var _g=this.dsDown.addRow();this.dsDown.copyRow(_g,this.dsFile,_i);}}var _e="SvcUrl::edu/downloadFile.do";this.FileDownTransfer00.setPostData("downloadId","");var _h=this.dsDown.saveXML();this.FileDownTransfer00.setPostData("downloadDs",encodeURIComponent(encodeURIComponent(_h)));this.FileDownTransfer00.set_downloadfilename("첨부파일.zip");this.FileDownTransfer00.download(_e);}};this.btn05_onclick=function(_a,_b){var _c=this.dsFile.extractRows("chkYN == '1'");if(_c.length==0){alert("선택하신 다운로드 할 파일이 없습니다");}else if(_c.length==1){var _d=this.dsFile.getcolumn(_c[0],"file_id");}else{for(i=0;i<_c.length;i++ ){var _e=this.dsDown.addRow();this.dsDown.copyRow(_e,this.dsFile.arrRow[i]);}}};this.grd00_ondrop=function(_a,_b){var _c=_b.filelist;};});this.on_initEvent=function(){this.grd00.addEventHandler("oncellclick",this.grd00_oncellclick,this);this.grd00.addEventHandler("ondrop",this.grd00_ondrop,this);this.btn00.addEventHandler("onclick",this.btn00_onclick,this);this.btn01.addEventHandler("onclick",this.btn01_onclick,this);this.btn02.addEventHandler("onclick",this.btn02_onclick,this);this.btn03.addEventHandler("onclick",this.btn03_onclick,this);this.btn04.addEventHandler("onclick",this.btn04_onclick,this);this.btn05.addEventHandler("onclick",this.btn05_onclick,this);this.FileUpTransfer00.addEventHandler("onsuccess",this.FileUpTransfer00_onsuccess,this);this.FileDialog00.addEventHandler("onclose",this.FileDialog00_onclose,this);};this.loadIncludeScript("frm_File.xfdl");this.loadPreloadList();_a=null;};})();